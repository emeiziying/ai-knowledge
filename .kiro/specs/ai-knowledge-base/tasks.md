# 实现计划

- [x] 1. 项目初始化和基础架构搭建

  - 创建项目目录结构，包含后端 API 服务和前端应用
  - 配置 Docker 和 Docker Compose 环境
  - 设置基础的依赖管理和构建配置
  - _需求: 1.1, 7.1, 7.3_

- [x] 2. 数据库和存储服务设置

  - 实现 PostgreSQL 数据库连接和配置
  - 集成 Qdrant 向量数据库服务
  - 配置 MinIO 对象存储服务
  - 创建数据库迁移脚本和初始化脚本
  - _需求: 1.1, 2.5, 3.5_

- [x] 3. 后端核心框架和中间件

  - 创建 FastAPI 应用基础结构
  - 实现请求路由和中间件配置
  - 添加 CORS、日志记录和错误处理中间件
  - 实现健康检查和系统状态端点
  - _需求: 1.1, 1.2, 1.3, 1.4_

- [x] 4. 用户认证和授权系统

  - 实现用户数据模型和数据库表
  - 创建 JWT 令牌生成和验证功能
  - 实现用户注册、登录和权限验证 API
  - 添加认证中间件和权限装饰器
  - _需求: 8.1, 8.3_

- [x] 5. 文档管理核心功能

  - 创建文档数据模型和 API 端点
  - 实现文档上传功能，包含文件验证和安全检查
  - 实现文档列表查询、详情获取和删除功能
  - 集成 MinIO 进行文件存储管理
  - _需求: 2.1, 2.2, 2.6, 2.7_

- [x] 6. 文档解析和内容提取

  - 实现多格式文档解析器（PDF、Word、TXT、Markdown）
  - 创建文本内容提取和预处理功能
  - 实现文档结构信息保留和元数据提取
  - 添加文档处理状态跟踪和错误处理
  - _需求: 2.3, 3.1, 3.2, 3.3, 3.6_

- [x] 7. 文档分块和向量化处理

  - 实现智能文档分块算法，保持语义完整性
  - 集成嵌入模型进行文本向量化
  - 实现向量存储到 Qdrant 数据库
  - 创建异步任务队列处理文档向量化
  - _需求: 2.4, 3.4, 3.5, 3.7_

- [x] 8. AI 服务集成和抽象层

  - 创建 AI 服务抽象接口和适配器模式
  - 实现 OpenAI API 集成（文本生成和嵌入）
  - 实现本地模型集成（Ollama 等）
  - 添加 AI 服务健康检查和故障转移机制
  - _需求: 5.1, 5.2, 5.5, 5.6, 5.7_

- [x] 9. RAG 查询和语义搜索

  - 实现用户问题向量化功能
  - 创建 Qdrant 向量搜索和相似度计算
  - 实现检索到的文档片段排序和过滤
  - 添加搜索结果缓存和优化
  - _需求: 4.1, 4.2, 2.8_

- [x] 10. 对话管理和上下文处理

  - 创建对话会话和消息数据模型
  - 实现对话历史存储和检索功能
  - 实现多轮对话上下文管理
  - 添加对话 API 端点（创建会话、发送消息、获取历史）
  - _需求: 4.6_

- [x] 11. RAG 问答核心逻辑

  - 实现问题和检索内容的提示词组合
  - 集成 AI 服务进行答案生成
  - 实现答案来源引用和链接提取
  - 添加无相关信息时的处理逻辑
  - _需求: 4.3, 4.4, 4.5, 4.7, 5.8_

- [x] 12. 错误处理和服务降级

  - 实现统一的错误响应格式和处理机制
  - 添加 AI 服务重试和熔断器模式
  - 实现服务降级策略（API 失败时切换本地模型）
  - 创建详细的错误日志和监控
  - _需求: 1.4, 4.8, 5.6_

- [x] 13. 前端项目初始化和基础组件

  - 创建 React + TypeScript 项目结构
  - 配置 Vite 构建工具和开发环境
  - 集成 Ant Design UI 组件库
  - 创建基础布局组件和路由配置
  - _需求: 6.1_

- [x] 14. 前端状态管理和 API 服务

  - 配置 Zustand 状态管理
  - 创建 API 服务层和 HTTP 客户端配置
  - 实现用户认证状态管理
  - 添加请求拦截器和错误处理
  - _需求: 6.1_

- [x] 15. 用户认证前端界面

  - 创建登录和注册页面组件
  - 实现 JWT 令牌存储和自动刷新
  - 添加路由守卫和权限控制
  - 创建用户信息显示和退出功能
  - _需求: 6.1, 8.1_

- [x] 16. 文档管理前端界面

  - 创建文档列表展示组件
  - 实现文件上传组件，支持拖拽和进度显示
  - 创建文档详情查看和删除功能
  - 实现文档搜索和过滤界面
  - _需求: 6.2, 2.1, 2.6, 2.7, 2.8_

- [x] 17. 对话查询前端界面

  - 创建聊天界面组件，类似聊天应用的设计
  - 实现消息发送和接收功能
  - 添加消息加载状态和错误提示
  - 实现对话历史展示和会话管理
  - _需求: 6.3, 4.1, 4.6_

- [ ] 18. 响应式设计和用户体验优化

  - 实现移动端响应式布局
  - 添加加载状态指示器和进度条
  - 优化文件上传和处理的用户反馈
  - 实现消息引用来源的点击跳转功能
  - _需求: 6.4, 6.5, 4.5_

- [ ] 19. Docker 容器化和部署配置

  - 创建后端服务的 Dockerfile
  - 创建前端应用的 Dockerfile 和 Nginx 配置
  - 编写完整的 Docker Compose 配置文件
  - 配置环境变量和数据持久化
  - _需求: 7.1, 7.2, 7.4_

- [ ] 20. 系统集成测试和优化
  - 编写 API 接口的集成测试
  - 创建文档处理流程的端到端测试
  - 实现前端组件的单元测试
  - 进行性能测试和优化调整
  - _需求: 1.1, 1.2, 1.3_
